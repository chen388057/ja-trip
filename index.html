<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>2026 JA è¦ªå­æ—…è¡Œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --m-bg: #F4F1EE; --m-card: #FFFFFF; --m-ink: #333333; --m-red: #AF292E; --m-gold: #D48806; --m-blue: #2E86C1; --m-green: #27AE60; }
        body { background-color: var(--m-bg); color: var(--m-ink); font-family: 'Noto Sans TC', sans-serif; -webkit-font-smoothing: antialiased; font-size: 19px; padding-bottom: 120px; }
        .weather-banner { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.3); border-radius: 20px; padding: 15px 20px; margin-bottom: 25px; display: flex; justify-content: space-between; align-items: center; }
        .muji-card { background: var(--m-card); border-radius: 24px; box-shadow: 0 6px 16px rgba(0,0,0,0.06); border: 1px solid #EAE6E2; overflow: hidden; margin-bottom: 20px; }
        .nav-active { background: #8E8A82 !important; color: white !important; transform: scale(1.05); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .badge { font-size: 14px; padding: 4px 10px; border-radius: 8px; font-weight: 800; margin-right: 6px; display: inline-block; margin-bottom: 6px; }
        .badge-res { background: #FADBD8; color: var(--m-red); }
        .nav-map-btn { display: inline-flex; align-items: center; background-color: #F8F9FA; color: #333; padding: 10px 18px; border-radius: 14px; font-size: 15px; font-weight: 700; margin-top: 14px; border: 1px solid #EEE; }
        .bottom-nav { background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(15px); border-top: 1px solid #E5E5E5; padding-bottom: env(safe-area-inset-bottom); }
        .ledger-row { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid #F0F0F0; }
        .ledger-input { border: none; border-bottom: 2px solid #EEE; background: transparent; width: 100%; padding: 12px 0; font-size: 18px; outline: none; }
    </style>
</head>
<body>

    <header class="px-6 pt-14 pb-2 flex justify-between items-end">
        <div>
            <h1 class="text-4xl font-black tracking-tight text-stone-800">2026 JA æ—…è¡Œ</h1>
            <div id="sync-status" class="text-[10px] text-green-600 font-bold mt-1 uppercase tracking-widest">â— Cloud Synced</div>
        </div>
        <p id="top-currency" class="text-xs font-bold text-stone-400 font-mono tracking-tighter uppercase">JPY Mode</p>
    </header>

    <nav class="sticky top-0 z-40 bg-[#F4F1EE]/95 backdrop-blur-md py-5 border-b border-stone-200">
        <div class="flex overflow-x-auto no-scrollbar px-6 space-x-4" id="date-nav"></div>
    </nav>

    <main class="px-6 py-6" id="main-content"></main>

    <footer class="bottom-nav fixed bottom-0 left-0 right-0 h-24 flex justify-around items-center z-50 px-8">
        <button onclick="switchMode('itinerary')" id="mode-itinerary" class="flex flex-col items-center gap-1 text-stone-800">
            <span class="text-3xl">ğŸ—“ï¸</span><span class="text-[11px] font-black uppercase">Schedule</span>
        </button>
        <button onclick="switchMode('ledger')" id="mode-ledger" class="flex flex-col items-center gap-1 text-stone-300">
            <span class="text-3xl">ğŸ’°</span><span class="text-[11px] font-black uppercase">Ledger</span>
        </button>
        <button onclick="switchMode('master')" id="mode-master" class="flex flex-col items-center gap-1 text-stone-300">
            <span class="text-3xl">ğŸ§³</span><span class="text-[11px] font-black uppercase">Vault</span>
        </button>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = { databaseURL: "https://ja-trip-2026-default-rtdb.firebaseio.com" };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        window.currentDayIdx = 0;
        window.currentMode = 'itinerary';
        window.expensesRaw = {};

        const dates = ["1/24", "1/25", "1/26", "1/27", "1/28", "1/29", "1/30", "1/31", "2/1", "2/2"];
        
        const ticketPdfs = [
            { cat: "ğŸš†", name: "è¼•äº•æ¾¤ JR å»ç¨‹ (1/24)", date: "1/24", url: "#" },
            { cat: "ğŸ¨", name: "Indigo é£¯åº—é ç´„å–®", date: "1/24", url: "#" },
            { cat: "ğŸ¨", name: "ç‹å­è¥¿é¤¨é ç´„å–®", date: "1/25", url: "#" },
            { cat: "ğŸš†", name: "è¼•äº•æ¾¤ JR å›ç¨‹ (1/27)", date: "1/27", url: "#" },
            { cat: "ğŸ¨", name: "å”è‰é£¯åº—é ç´„å–®", date: "1/27", url: "#" },
            { cat: "ğŸ§±", name: "æ¨‚é«˜æ¢ç´¢ä¸­å¿ƒé–€ç¥¨", date: "1/29", url: "#" },
            { cat: "ğŸ¦–", name: "ä¸Šé‡ç§‘å­¸åšç‰©é¤¨é ç´„", date: "1/30", url: "#" },
            { cat: "ğŸŸ", name: "æ± è¢‹æ°´æ—é¤¨é–€ç¥¨", date: "1/31", url: "#" },
            { cat: "ğŸ¨", name: "æ›¼è°· MII Hotel é ç´„", date: "2/1", url: "#" }
        ];

        const tripData = [
            { date: "1/24", weekday: "å…­", city: "è¼•äº•æ¾¤", weather: "â„ï¸ -6Â° / -1Â°", rain: "10%", items: [
                { time: "06:00", title: "æ©Ÿå ´æ¥é€ ğŸš—", desc: "æ ¼ä¸Šç§Ÿè»Šå‰å¾€æ¡ƒåœ’æ©Ÿå ´", loc: "æ¡ƒåœ’æ©Ÿå ´" },
                { time: "09:30", title: "è¯èˆª CI0100 âœˆï¸", desc: "æˆç”° | åº§ä½ <span class='badge badge-res'>47DEFG</span>", loc: "æ¡ƒåœ’æ©Ÿå ´" },
                { time: "13:30", title: "æŠµé”æˆç”°æ©Ÿå ´", desc: "ç¬¬äºŒèˆªå»ˆé€šé—œ", loc: "æˆç”°åœ‹éš›æ©Ÿå ´ç¬¬2èˆªå»ˆ" },
                { time: "15:00", title: "Skyliner ğŸš…", desc: "å‰å¾€äº¬æˆä¸Šé‡ | <span class='badge badge-res'>åˆ·è‡‰éé–˜æ©Ÿ</span>", loc: "äº¬æˆä¸Šé‡ç«™" },
                { time: "16:38", title: "æ–°å¹¹ç·š Hakutaka ğŸš…", desc: "åº§è™Ÿ <span class='badge badge-res'>9è™Ÿ1ç•ªABC/2ç•ªC</span>", loc: "ä¸Šé‡ç«™" },
                { time: "17:35", title: "æŠµé”è¼•äº•æ¾¤ç«™", desc: "æº–å‚™é£¯åº—æ¥é§" },
                { time: "18:00", title: "å…¥ä½ Indigo ğŸ¨", desc: "æ¨™æº–é›™åºŠæˆ¿(å«æ—©)", loc: "Hotel Indigo Karuizawa" }
            ]},
            { date: "1/25", weekday: "æ—¥", city: "è¼•äº•æ¾¤", weather: "â„ï¸ -8Â° / 1Â°", rain: "5%", items: [
                { time: "07:00", title: "é£¯åº—æ—©é¤ ğŸ³", desc: "äº«ç”¨ Indigo æ—©é¤" },
                { time: "08:30", title: "é›ªå ´æº–å‚™ ğŸ¿", desc: "æ±é¤¨é›ªå…·ç§Ÿè³ƒè™•é›†åˆè‘—è£", loc: "è¼•äº•æ¾¤ç‹å­æ»‘é›ªå ´" },
                { time: "09:00", title: "æ»‘é›ªèª²ç¨‹ ğŸ¿", desc: "æ¢é›ªè€…å­¸æ ¡èª²ç¨‹", loc: "è¼•äº•æ¾¤ç‹å­æ»‘é›ªå ´" },
                { time: "12:00", title: "é›ªå ´åˆé¤ ğŸ±", desc: "Snow House 2F ç”¨é¤æˆ–å¤–å¸¶", loc: "è¼•äº•æ¾¤æ»‘é›ªå ´" },
                { time: "14:00", title: "Hotel Indigo é€€æˆ¿", desc: "Check-out" },
                { time: "15:00", title: "å…¥ä½è¥¿é¤¨å°æœ¨å±‹ ğŸ¡", desc: "West D å°æœ¨å±‹", loc: "Karuizawa Prince Hotel West" },
                { time: "16:00", title: "èˆŠè¼•äº•æ¾¤éŠ€åº§é€š", desc: "æ•£ç­–èˆ‡æ™šé¤ã€‚æ¥é§æ­å¾ªç’°å·´å£«", loc: "èˆŠè¼•äº•æ¾¤éŠ€åº§é€š" }
            ]},
            { date: "1/26", weekday: "ä¸€", city: "è¼•äº•æ¾¤", weather: "â˜ï¸ -5Â° / 2Â°", rain: "0%", items: [
                { time: "07:30", title: "è‡ªå‚™æ—©é¤ ğŸ¥¯", desc: "å°æœ¨å±‹æ—©æ™¨" },
                { time: "08:30", title: "å‰å¾€æ»‘é›ªå ´", desc: "æ­ä¹˜æ¥é§è»Š" },
                { time: "09:00", title: "æ»‘é›ªèª²ç¨‹ Day 2 ğŸ¿", desc: "é€²éšæ»‘é›ªç·´ç¿’" },
                { time: "13:00", title: "ç‹å­ Outlet ğŸ›ï¸", desc: "é ˜å„ªæƒ åˆ¸ã€‚é€›æ¨‚é«˜ã€è¶…å¸‚ç­‰", loc: "è¼•äº•æ¾¤ç‹å­è³¼ç‰©å»£å ´" },
                { time: "17:00", title: "Outlet æ™šé¤ ğŸ±", desc: "ç‡Ÿæ¥­è‡³ 19:00", loc: "è¼•äº•æ¾¤ç‹å­è³¼ç‰©å»£å ´" }
            ]},
            { date: "1/27", weekday: "äºŒ", city: "æ±äº¬", weather: "â˜ï¸ 2Â° / 9Â°", rain: "20%", items: [
                { time: "08:30", title: "é£¯åº—é€€æˆ¿ ğŸ¨", desc: "å¯„å­˜è¡Œæ" },
                { time: "09:00", title: "Snowman Park â›„", desc: "é–€ç¥¨ Â¥1400 / é›ªç›† Â¥500", loc: "è¼•äº•æ¾¤æ»‘é›ªå ´" },
                { time: "13:57", title: "æ–°å¹¹ç·š Asama 616 ğŸš…", desc: "åº§è™Ÿ <span class='badge badge-res'>9è™Ÿ16/17ç•ªDE</span>", loc: "è¼•äº•æ¾¤ç«™" },
                { time: "15:30", title: "å…¥ä½å”è‰é£¯åº— ğŸ¨", desc: "æ±äº¬å…«é‡æ´² (å«æ—©)", loc: "karaksa hotel colors Tokyo Yaesu" },
                { time: "16:00", title: "å¯¶å¯å¤¢ä¸­å¿ƒ DX ğŸ‰", desc: "æ—¥æœ¬æ©‹é«˜å³¶å±‹ 5F", loc: "å¯¶å¯å¤¢ä¸­å¿ƒæ±äº¬æ—¥æœ¬æ©‹åº— DX" },
                { time: "17:30", title: "ç¦ã¿ã¿ éŠ€åº§ 6 ğŸ¢", desc: "å·²é ç´„æ™šé¤", loc: "ä¸²ä¸²ç‡’ BISTRO ç¦ã¿ã¿ éŠ€åº§ 6" },
                { time: "19:30", title: "å”å‰è¨¶å¾· ğŸ›’", desc: "éŠ€åº§åº— 24H ç‡Ÿæ¥­", loc: "å”å‰è¨¶å¾· éŠ€åº§æœ¬é¤¨" }
            ]},
            { date: "1/28", weekday: "ä¸‰", city: "æ±äº¬", weather: "â˜€ï¸ 4Â° / 11Â°", rain: "0%", items: [
                { time: "08:00", title: "é£¯åº—æ—©é¤ ğŸ¥", desc: "å”è‰æ—©é¤" },
                { time: "09:30", title: "éµå¡”æ”å½± ğŸ—¼", desc: "èµ¤ç¾½æ©‹ç«™åŠèŠå…¬åœ’", loc: "èŠå…¬åœ’" },
                { time: "10:30", title: "æ˜æ²»ç¥å®® â›©ï¸", desc: "åƒæ‹œç¥å®®", loc: "æ˜æ²»ç¥å®®" },
                { time: "12:00", title: "æ¾€è°·åˆé¤ ğŸ›", desc: "æ¾€è°· Parco åœŸé‹é£¯", loc: "æ¾€è°· PARCO" },
                { time: "15:00", title: "è—ç“¶å’–å•¡ â˜•", desc: "æ¾€è°·å…¬åœ’åº—", loc: "Blue Bottle Coffee Shibuya" },
                { time: "17:00", title: "ä¸€ç•ªè¡—é—œæ±ç…® ğŸ¢", desc: "é—œæ±ç…®æ™šé¤", loc: "æ±äº¬è»Šç«™ä¸€ç•ªè¡—" }
            ]},
            { date: "1/29", weekday: "å››", city: "æ±äº¬", weather: "â˜ï¸ 3Â° / 10Â°", rain: "10%", items: [
                { time: "09:00", title: "teamLab Planets âœ¨", desc: "å·²é ç´„ / éœ€è„«é‹è¥ª", loc: "teamLab Planets TOKYO" },
                { time: "12:30", title: "å°å ´ Bills ğŸ¥", desc: "å·²é ç´„åˆé¤", loc: "Bills Odaiba" },
                { time: "14:00", title: "æ¨‚é«˜æ¢ç´¢ä¸­å¿ƒ ğŸ§±", desc: "å·²é ç´„åƒè§€", loc: "LEGOLAND Tokyo" },
                { time: "18:00", title: "èˆ‡ç‘ªå§¬å§é¤æ•˜ ğŸ·", desc: "èšé¤æ™‚é–“" }
            ]},
            { date: "1/30", weekday: "äº”", city: "æ±äº¬", weather: "â˜€ï¸ 4Â° / 12Â°", rain: "0%", items: [
                { time: "09:00", title: "é›·é–€åƒæ‹œ â›©ï¸", desc: "æ·ºè‰å¯ºåƒæ‹œ", loc: "æ·ºè‰é›·é–€" },
                { time: "11:00", title: "æ™´ç©ºå¡”ç™»å¡” ğŸ—¼", desc: "å·²é ç´„å¤©æœ›è¿´å»Š", loc: "æ±äº¬æ™´ç©ºå¡”" },
                { time: "12:00", title: "æ•˜æ•˜è‹‘ç‡’è‚‰ ğŸ¥©", desc: "30F æ™¯è§€é ç´„å¸­", loc: "æ•˜æ•˜è‹‘ æ™´ç©ºå¡”åº—" },
                { time: "15:00", title: "ç§‘å­¸åšç‰©é¤¨ ğŸ¦–", desc: "å·²é ç´„åƒè§€", loc: "åœ‹ç«‹ç§‘å­¸åšç‰©é¤¨" },
                { time: "18:00", title: "ã­ãã— ç‰›èˆŒ ğŸ‘…", desc: "ä¸Šé‡ç«™å‰åº—", loc: "Negishi Ueno" }
            ]},
            { date: "1/31", weekday: "å…­", city: "æ±äº¬", weather: "â˜ï¸ 5Â° / 10Â°", rain: "30%", items: [
                { time: "09:30", title: "æ± è¢‹æ°´æ—é¤¨ ğŸŸ", desc: "å·²é ç´„ / çœ‹æµ·ç…", loc: "æ± è¢‹å¤ªé™½åŸæ°´æ—é¤¨" },
                { time: "11:30", title: "å¯¶å¯å¤¢ä¸­å¿ƒ ğŸ‰", desc: "æ± è¢‹ Mega Tokyo åº—", loc: "Pokemon Center Mega Tokyo" },
                { time: "13:30", title: "å’Œå¹¸ç‚¸è±¬æ’ ğŸ›", desc: "å¤ªé™½åŸåº—", loc: "Tonkatsu Wako" },
                { time: "18:30", title: "å¡šç”°è¾²å ´ ğŸ“", desc: "å…«é‡æ´²åŒ—å£é ç´„æ™šé¤", loc: "å¡šç”°è¾²å ´ å…«é‡æ´²åŒ—å£" }
            ]},
            { date: "2/1", weekday: "æ—¥", city: "æ›¼è°·", weather: "â˜€ï¸ 27Â° / 34Â°", rain: "0%", items: [
                { time: "09:20", title: "CI0107 âœˆï¸", desc: "æˆç”° â” æ¡ƒåœ’ | <span class='badge badge-res'>51CHJK</span>", loc: "æˆç”°æ©Ÿå ´" },
                { time: "13:50", title: "CI0835 âœˆï¸", desc: "æ¡ƒåœ’ â” æ›¼è°· | <span class='badge badge-res'>11DGEF</span>", loc: "æ¡ƒåœ’æ©Ÿå ´" },
                { time: "18:30", title: "å…¥ä½ MII Hotel ğŸ¨", desc: "MII Hotel Srinagarindra", loc: "MII Hotel Srinagarindra" },
                { time: "19:00", title: "MK ç«é‹æ™šé¤ ğŸ²", desc: "è¥¿åº·å»£å ´åº—", loc: "Seacon Square" }
            ]},
            { date: "2/2", weekday: "ä¸€", city: "æ­¸é€”", weather: "â˜€ï¸ 28Â° / 35Â°", rain: "0%", items: [
                { time: "10:00", title: "å”å‰è¨¶å¾·æ¡è³¼ ğŸ§", desc: "è¥¿åº·å»£å ´åº—", loc: "Don Don Donki Seacon Square" },
                { time: "14:40", title: "é•·æ¦® BR0202 âœˆï¸", desc: "<span class='badge badge-res'>è±ªç¶“è‰™</span> è¿”å°", loc: "æ›¼è°·æ©Ÿå ´" },
                { time: "19:15", title: "æŠµå°è¿”å®¶ ğŸ ", desc: "æ ¼ä¸Šæ¥é€è¿”å›å®¶ä¸­" }
            ]}
        ];

        window.renderContent = function() {
            const container = document.getElementById('main-content');
            const dateKey = dates[window.currentDayIdx];
            const currency = dateKey.includes('2/') ? 'THB' : 'JPY';
            document.getElementById('top-currency').innerText = `${currency} MODE`;

            if (window.currentMode === 'itinerary') {
                const data = tripData[window.currentDayIdx];
                let html = `<div class="weather-banner"><div><p class="text-[10px] text-stone-400 font-bold uppercase">${data.city}</p><p class="text-2xl font-black">${data.weather}</p></div><div class="text-right border-l pl-4 border-stone-200"><p class="text-[10px] text-stone-400 font-bold uppercase">é™é›¨ç‡</p><p class="text-xl font-black">${data.rain}</p></div></div>`;
                data.items.forEach(item => {
                    html += `<div class="muji-card p-6"><div class="flex justify-between items-start mb-2"><span class="text-xl font-black text-stone-300 font-mono">${item.time}</span></div><h3 class="text-2xl font-black text-stone-800 mb-2 leading-tight">${item.title}</h3><p class="text-lg text-stone-500 leading-relaxed">${item.desc}</p>${item.loc ? `<a href="http://googleusercontent.com/maps.google.com/4{encodeURIComponent(item.loc)}" target="_blank" class="nav-map-btn">ğŸ“ å°èˆª</a>` : ''}</div>`;
                });
                container.innerHTML = html;
            } 
            else if (window.currentMode === 'ledger') {
                const dayExp = window.expensesRaw[dateKey.replace(/\//g, '-')] || {};
                let total = 0;
                let listHtml = '';
                Object.keys(dayExp).forEach(id => {
                    const item = dayExp[id]; total += item.amount;
                    listHtml += `<div class="ledger-row"><p class="font-bold">${item.name}</p><div class="flex items-center gap-4"><span class="font-black">${item.amount}</span><button onclick="window.deleteExp('${id}')" class="text-stone-300">Ã—</button></div></div>`;
                });
                container.innerHTML = `<div class="muji-card p-8 text-center"><p class="text-stone-400 text-xs font-bold uppercase">Today Total</p><p class="text-5xl font-black mt-2">${total}</p></div><div class="muji-card p-6">${listHtml || '<p class="text-center py-6 text-stone-300">å°šæœªè¨˜å¸³</p>'}</div><div class="muji-card p-6"><input type="text" id="exp-name" class="ledger-input mb-4" placeholder="å“é …..."><input type="number" id="exp-amount" class="ledger-input mb-6" placeholder="é‡‘é¡..."><button onclick="window.addExp()" class="w-full bg-stone-800 text-white py-4 rounded-xl font-bold">åŒæ­¥é›²ç«¯</button></div>`;
            } else {
                let pdfHtml = ticketPdfs.map(pdf => `<a href="${pdf.url}" target="_blank" class="ticket-btn"><div class="flex-1 font-bold text-stone-800">${pdf.cat} ${pdf.name}</div><div class="text-xs text-stone-400">${pdf.date}</div></a>`).join('');
                container.innerHTML = `<h2 class="text-stone-400 font-bold uppercase text-xs mb-4 tracking-widest">Digital Vault</h2>${pdfHtml}`;
            }
        };

        window.addExp = () => {
            const n = document.getElementById('exp-name').value;
            const a = parseInt(document.getElementById('exp-amount').value);
            if(!n || isNaN(a)) return;
            push(ref(db, 'expenses/' + dates[window.currentDayIdx].replace(/\//g, '-')), { name: n, amount: a });
            document.getElementById('exp-name').value = ''; document.getElementById('exp-amount').value = '';
        };

        window.deleteExp = (id) => { if(confirm('åˆªé™¤ç´€éŒ„ï¼Ÿ')) remove(ref(db, `expenses/${dates[window.currentDayIdx].replace(/\//g, '-')}/${id}`)); };

        window.switchMode = (m) => {
            window.currentMode = m;
            ['itinerary', 'ledger', 'master'].forEach(id => document.getElementById('mode-' + id).classList.replace('text-stone-800', 'text-stone-300'));
            document.getElementById('mode-' + m).classList.replace('text-stone-300', 'text-stone-800');
            window.renderContent();
        };

        const nav = document.getElementById('date-nav');
        dates.forEach((d, i) => {
            const btn = document.createElement('button');
            btn.className = `flex-shrink-0 px-7 py-3 rounded-2xl bg-white text-lg font-black border border-stone-200 transition-all ${i === 0 ? 'nav-active' : ''}`;
            btn.innerText = d;
            btn.onclick = (e) => {
                window.currentDayIdx = i;
                document.querySelectorAll('#date-nav button').forEach(b => b.classList.remove('nav-active'));
                e.currentTarget.classList.add('nav-active');
                window.renderContent();
            };
            nav.appendChild(btn);
        });

        onValue(ref(db, 'expenses'), (snap) => {
            window.expensesRaw = snap.val() || {};
            window.renderContent();
        });

        window.renderContent();
    </script>
</body>
</html>
